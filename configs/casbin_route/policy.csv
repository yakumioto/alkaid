# 角色定义

g, organization::role, network::role, *
g, organization::role, user::role, *
g, network::role, user::role, *

# 角色路由权限定义
p, *, *, /health, GET, allow
p, *, *, /initialize, POST, allow
p, *, *, /login, POST, allow
p, *, *, /users, POST, allow

p, root::role, *, *, *, allow
p, organization::role, *, /networks, POST, allow
p, organization::role, *, /organizations/:id, GET, allow
p, organization::role, *, /organizations/:id, PATCH, allow
p, organization::role, *, /organizations/:organizationId/users, *, allow

p, network::role, *, /networks/:id, GET, allow
p, network::role, *, /networks/:id, POST, allow
p, network::role, *, /networks/:id, PATCH, allow
p, network::role, *, /services/:id, *, allow
p, network::role, *, /channels/:id, *, allow
p, network::role, *, /contracts/:id, *, allow
p, network::role, *, /organizations/:organizationId/networks, *, allow
p, network::role, *, /organizations/:organizationId/networks/:networkId/services, *, allow
p, network::role, *, /organizations/:organizationId/networks/:networkId/channels, *, allow
p, network::role, *, /organizations/:organizationId/networks/:networkId/channels/:channelId/contracts, *, allow

p, user::role, *, /users/:id, GET, allow
p, user::role, *, /users/:id, POST, allow
p, user::role, *, /users/:id, PATCH, allow
p, user::role, *, /organizations, POST, allow
p, user::role, *, /organizations/:id, GET, allow
p, user::role, *, /networks/:id, GET, allow
p, user::role, *, /services/:id, GET, allow
p, user::role, *, /channels/:id, GET, allow
p, user::role, *, /contracts/:id, GET, allow
p, user::role, *, /contracts/:id/execute, POST, allow
p, user::role, *, /organizations/:organizationId/networks, GET, allow
p, user::role, *, /organizations/:organizationId/networks/:networkId/services, GET, allow
p, user::role, *, /organizations/:organizationId/networks/:networkId/channels, GET, allow
p, user::role, *, /organizations/:organizationId/networks/:networkId/channels/:channelId/contracts, GET, allow

# TODO: 动态生成
# 根据用户允许访问的资源动态添加
# example：
# g, exampleUser, user::role, exampleOrganization
# p, exampleUser, exampleOrganization, b3a1f95f-9e05-420f-872c-d09944974539, *, allow
